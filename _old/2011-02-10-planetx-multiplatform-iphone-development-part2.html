---
layout: post
title: 'PlanetX, multiplatform: iPhone development (Part:2) #iPhone #WP7 #Xbox #XNA
  #Monotouch #XnaTouch'
date: 2011-02-10 02:14:23.000000000 +00:00
type: post
published: true
status: publish
categories:
- ".NET"
- iPhone
- WP7
- XBOX
- XNA
tags: []
meta:
  _oembed_b8d01ef6539c22a2e280ef33da445876: "{{unknown}}"
  _oembed_e9b36d0b39f38ec5fa459617f2384f36: "{{unknown}}"
author:
  login: smnbss
  email: smnbss@hotmail.com
  display_name: smnbss
  first_name: ''
  last_name: ''
---
<p>May be this blue screen does not mean much to you, but any XNA developer will be able to recognize the standard Blue XNA background…</p>
<p><a href="http://smnbss.files.wordpress.com/2011/02/capture.png"><img style="background-image:none;padding-left:0;padding-right:0;display:inline;padding-top:0;border-width:0;" title="Capture" border="0" alt="Capture" src="{{ site.baseurl }}/assets/capture_thumb.png" width="584" height="370" /></a></p>
<p>Basically the same code that works for the WP7, work on the iPhone emulator, on Windows and on the Xbox</p>
<p><a href="http://smnbss.files.wordpress.com/2011/02/image9.png"><img style="background-image:none;padding-left:0;padding-right:0;display:inline;padding-top:0;border-width:0;" title="image" border="0" alt="image" src="{{ site.baseurl }}/assets/image_thumb9.png" width="580" height="468" /></a></p>
<p>Tomorrow you’ll see sprites popping out of these small screens <img style="border-style:none;" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="{{ site.baseurl }}/assets/wlemoticon-smile1.png" />.</p>
<p>To achieve this, basically you need to setup monodevelop, monotouch, xnatouch and all that jazz, create a windows Xna game from Visual studio 2010, create a copy of the project for WP7 (right click on the windows project)</p>
<p><a href="http://smnbss.files.wordpress.com/2011/02/image10.png"><img style="background-image:none;padding-left:0;padding-right:0;display:inline;padding-top:0;border-width:0;" title="image" border="0" alt="image" src="{{ site.baseurl }}/assets/image_thumb10.png" width="244" height="59" /></a></p>
<p>Then you need to take one of the examples that comes with XnaTouch, delete all the files, and add all the files from the windows xna game.</p>
<p>I suggest you to use linked files in order to have a single codebase, and use svn to share the code between your VS2010 Windows instance and your OSX Monodevelop instance.</p>
<p>I’m using <a href="http://www.zennaware.com/cornerstone/">http://www.zennaware.com/cornerstone/</a> as svn client on OSX. I’ve never used a mac before and the way this svn implementation works is a bit strange to me, but might be more familiar to those coming from the MAC. I prefer a million times Visual Svn, integrated with VS, but there’s noting like that for monodevelop on OSX.</p>
<p>Once you’ve done all this, the project will fail to compile on OSX, because the Microsoft.Xna namespace does not exist, so you have to replace it with</p>
<p>&#160;</p>
<pre>#if IPHONE<br />using MonoTouch.Foundation;<br />using MonoTouch.UIKit;<br />using XnaTouch;<br />using XnaTouch.Framework.Media;<br />#else<br />using Microsoft.Xna.Framework;<br />using Microsoft.Xna.Framework.Media;<br />#endif</pre>
<p>&#160;</p>
<p>Basically, this is my Program.cs file</p>
<pre>#region Using Statements<br />using System;<br />#if IPHONE<br />using MonoTouch.Foundation;<br />using MonoTouch.UIKit;<br />using XnaTouch;<br />using XnaTouch.Framework.Media;<br />#else<br />using Microsoft.Xna.Framework;<br />using Microsoft.Xna.Framework.Media;<br />#endif<br />#endregion<br /> <br />namespace XPlanets<br />{<br />#if IPHONE<br />&#160;&#160;&#160; [Register (&quot;AppDelegate&quot;)]<br />	class Program : UIApplicationDelegate <br />	{<br />		public override void FinishedLaunching (UIApplication app)<br />		{<br />			// Fun begins..<br />			using (XPlanetsGame game = new XPlanetsGame())<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; game.Run();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />			<br />			//MediaLibrary lib = new MediaLibrary();<br />			//object result = lib.Playlists;<br />		}<br /> <br />		static void Main (string [] args)<br />		{<br />			UIApplication.Main (args,null,&quot;AppDelegate&quot;);<br />		}<br />	}<br />#elif WINDOWS || XBOX<br />&#160;&#160;&#160; static class Program<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// &lt;summary&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// The main entry point for the application.<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// &lt;/summary&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; static void Main(string[] args)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; using (XPlanetsGame game = new XPlanetsGame())<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; game.Run();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160; }<br />#endif<br />}<br /> <br /></pre>
<p>and this is my XplanetGame file</p>
<pre>using System;<br />using System.Collections.Generic;<br />using System.Linq;<br />#if IPHONE<br />using MonoTouch.Foundation;<br />using MonoTouch.UIKit;<br />using XnaTouch;<br />using XnaTouch.Framework;<br />using XnaTouch.Framework.Media;<br />using XnaTouch.Framework.Graphics;<br />using XnaTouch.Framework.Input;<br />#else<br />using Microsoft.Xna.Framework;<br />using Microsoft.Xna.Framework.Graphics;<br />using Microsoft.Xna.Framework.Input;<br />#endif<br /> <br />namespace XPlanets<br />{<br />&#160;&#160;&#160; /// &lt;summary&gt;<br />&#160;&#160;&#160; /// This is the main type for your game<br />&#160;&#160;&#160; /// &lt;/summary&gt;<br />&#160;&#160;&#160; public class XPlanetsGame : Game<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; GraphicsDeviceManager graphics;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; SpriteBatch spriteBatch;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; public XPlanetsGame()<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; graphics = new GraphicsDeviceManager(this);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Content.RootDirectory = &quot;Content&quot;;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Frame rate is 30 fps by default for Windows Phone.<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; TargetElapsedTime = TimeSpan.FromTicks(333333);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// &lt;summary&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// Allows the game to perform any initialization it needs to before starting to run.<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// This is where it can query for any required services and load any non-graphic<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// related content.&#160; Calling base.Initialize will enumerate through any components<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// and initialize them as well.<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// &lt;/summary&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; protected override void Initialize()<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // TODO: Add your initialization logic here<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; base.Initialize();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// &lt;summary&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// LoadContent will be called once per game and is the place to load<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// all of your content.<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// &lt;/summary&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; protected override void LoadContent()<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Create a new SpriteBatch, which can be used to draw textures.<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; spriteBatch = new SpriteBatch(GraphicsDevice);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // TODO: use this.Content to load your game content here<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// &lt;summary&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// UnloadContent will be called once per game and is the place to unload<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// all content.<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// &lt;/summary&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; protected override void UnloadContent()<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // TODO: Unload any non ContentManager content here<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// &lt;summary&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// Allows the game to run logic such as updating the world,<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// checking for collisions, gathering input, and playing audio.<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// &lt;/summary&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// &lt;param name=&quot;gameTime&quot;&gt;Provides a snapshot of timing values.&lt;/param&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; protected override void Update(GameTime gameTime)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Allows the game to exit<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (GamePad.GetState(PlayerIndex.One).Buttons.Back == ButtonState.Pressed)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; this.Exit();<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // TODO: Add your update logic here<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; base.Update(gameTime);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// &lt;summary&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// This is called when the game should draw itself.<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// &lt;/summary&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; /// &lt;param name=&quot;gameTime&quot;&gt;Provides a snapshot of timing values.&lt;/param&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; protected override void Draw(GameTime gameTime)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; GraphicsDevice.Clear(Color.CornflowerBlue);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // TODO: Add your drawing code here<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; base.Draw(gameTime);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160; }<br />}<br /></pre>
<p>In this way, you have a single codebase, where 90% of the code is exactly the same on all the devices, and you can optimize or customize for a specific device using C# Preprocessor directives.</p>
<p>You’ll see this block many many times:</p>
<p>&#160;</p>
<pre>#if IPHONE<br />//iPhone<br />#elif XBOX<br />//XBox<br />#elif WINDOWS<br />//Windows<br />#elif WINDOWS_PHONE<br />//Windows Phone<br />#endif</pre>
